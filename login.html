<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Login</title>
  <link rel="icon" type="image/x-icon" href="images/logo.png">

  <style>
    /* ===== Premium Dark Theme (JYRA) ===== */
    :root{
      --bg:#07080d;
      --panel: rgba(12,14,22,.62);
      --panel2: rgba(0,0,0,.35);
      --stroke: rgba(255,255,255,.10);

      --text:#eaf0ff;
      --muted: rgba(234,240,255,.70);

      --gold:#d4af37;
      --gold2:#f0d47a;
      --goldSoft: rgba(212,175,55,.18);

      --blue:#3aa6ff;
      --blueSoft: rgba(58,166,255,.18);

      --danger:#ff5c6c;
      --radius:18px;
      --shadow: 0 22px 70px rgba(0,0,0,.65);
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      color:var(--text);
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Noto Sans", "Helvetica Neue", sans-serif;
      background: var(--bg);
      overflow-x:hidden;
    }

    /* ===== Background ===== */
    .bg{
      position:fixed; inset:0;
      background:
        radial-gradient(1100px 700px at 20% 12%, rgba(212,175,55,.12), transparent 58%),
        radial-gradient(900px 600px at 80% 88%, rgba(58,166,255,.10), transparent 60%),
        linear-gradient(180deg, rgba(0,0,0,.25), rgba(0,0,0,.70));
      z-index:-2;
    }
    .bg::before{
      content:"";
      position:absolute; inset:0;
      /* ‚úÖ Option A (Recommended): Local image */
      background-image: url("./bg-login.jpg");

      /* ‚úÖ Option B (Online demo link) - uncomment to use:
      background-image: url("https://images.unsplash.com/photo-1520694478162-5b0f3a6f8f3a?auto=format&fit=crop&w=1600&q=70");
      */

      background-size:cover;
      background-position:center;
      filter: saturate(.9) contrast(1.05) brightness(.75);
      opacity:.85;
    }
    .bg::after{
      content:"";
      position:absolute; inset:0;
      background:
        radial-gradient(900px 600px at 50% 35%, rgba(255,255,255,.05), transparent 60%),
        linear-gradient(180deg, rgba(0,0,0,.55), rgba(0,0,0,.78));
      z-index:1;
      pointer-events:none;
    }

    /* ===== Top Nav ===== */
    .nav{
      position:sticky; top:0; z-index:10;
      backdrop-filter: blur(10px);
      background: rgba(0,0,0,.28);
      border-bottom: 1px solid rgba(255,255,255,.08);
    }
    .nav .container{
      max-width: 1080px;
      margin: 0 auto;
      padding: 12px 16px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
    }
    .brand{
      display:flex; align-items:center; gap:10px;
      min-width: 0;
    }
    .logo{
      width: 42px; height:42px;
      border-radius:12px;
      object-fit:contain;
      background: rgba(255,255,255,.04);
      border: 1px solid rgba(255,255,255,.10);
      box-shadow: 0 10px 30px rgba(0,0,0,.35);
    }
    .brand-title{
      display:flex; flex-direction:column; line-height:1.05;
      min-width:0;
    }
    .brand-title strong{
      font-size:14px; letter-spacing:.8px;
      text-transform: uppercase;
      white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
    }
    .brand-title span{
      font-size:12px; color: var(--muted);
      white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
    }

    /* ===== Layout ===== */
    .wrap{
      min-height: calc(100% - 70px);
      display:grid;
      place-items:center;
      padding: 28px 14px 36px;
    }

    /* ===== Premium Card ===== */
    .card{
      width:100%;
      max-width: 520px;
      border-radius: var(--radius);
      background:
        linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      border: 1px solid rgba(255,255,255,.10);
      box-shadow: var(--shadow);
      position:relative;
      overflow:hidden;
    }
    .card::before{
      content:"";
      position:absolute; inset:-2px;
      background:
        radial-gradient(380px 160px at 30% 0%, rgba(212,175,55,.22), transparent 60%),
        radial-gradient(340px 180px at 90% 100%, rgba(58,166,255,.18), transparent 60%);
      opacity:.9;
      pointer-events:none;
    }
    .card-inner{
      position:relative;
      background: rgba(8,10,16,.55);
      border: 1px solid rgba(255,255,255,.08);
      margin: 10px;
      border-radius: calc(var(--radius) - 8px);
      padding: 18px 18px 16px;
    }

    .title{
      display:flex;
      flex-direction:column;
      gap:6px;
      align-items:center;
      text-align:center;
      padding: 8px 6px 12px;
    }
    .title h1{
      margin:0;
      font-size: 22px;
      letter-spacing: 1px;
      text-transform: uppercase;
    }
    .title p{
      margin:0;
      color: var(--muted);
      font-size: 13px;
    }
    .accent-line{
      width: 86px;
      height: 3px;
      border-radius: 99px;
      background: linear-gradient(90deg, rgba(212,175,55,.85), rgba(58,166,255,.75));
      opacity:.95;
      margin-top: 6px;
    }

    .field{
      margin-top: 12px;
    }
    .field label{
      display:block;
      font-size: 12px;
      color: rgba(234,240,255,.82);
      margin: 0 0 6px 2px;
      letter-spacing:.2px;
    }
    .control{
      display:flex;
      align-items:center;
      gap:10px;
      padding: 12px 12px;
      border-radius: 14px;
      background: rgba(0,0,0,.35);
      border: 1px solid rgba(255,255,255,.10);
      box-shadow: inset 0 0 0 1px rgba(0,0,0,.35);
      transition: .18s ease;
    }
    .control:focus-within{
      border-color: rgba(212,175,55,.45);
      box-shadow:
        0 0 0 3px rgba(212,175,55,.12),
        inset 0 0 0 1px rgba(0,0,0,.35);
    }
    .ico{
      width: 34px;
      height: 34px;
      display:grid;
      place-items:center;
      border-radius: 12px;
      background: rgba(255,255,255,.04);
      border: 1px solid rgba(255,255,255,.08);
      color: rgba(234,240,255,.85);
      flex: 0 0 34px;
      user-select:none;
    }
    input{
      width:100%;
      border:0;
      outline:0;
      background: transparent;
      color: var(--text);
      font-size: 14px;
    }
    input::placeholder{ color: rgba(234,240,255,.45); }

    .pw-toggle{
      border:0;
      background: rgba(255,255,255,.04);
      color: rgba(234,240,255,.85);
      border: 1px solid rgba(255,255,255,.10);
      border-radius: 12px;
      padding: 9px 10px;
      cursor:pointer;
      transition: .18s ease;
    }
    .pw-toggle:hover{
      transform: translateY(-1px);
      border-color: rgba(58,166,255,.30);
    }

    .btn{
      margin-top: 14px;
      width:100%;
      padding: 12px 14px;
      border:0;
      cursor:pointer;
      border-radius: 14px;
      font-weight: 700;
      letter-spacing: .6px;
      text-transform: uppercase;
      color: #111;
      background:
        linear-gradient(180deg, var(--gold2), var(--gold));
      box-shadow:
        0 14px 36px rgba(212,175,55,.18),
        inset 0 0 0 1px rgba(0,0,0,.20);
      transition: .18s ease;
    }
    .btn:hover{ transform: translateY(-1px); }
    .btn:disabled{
      opacity:.7;
      cursor:not-allowed;
      transform:none;
    }

    .notice{
      margin-top: 12px;
      padding: 10px 12px;
      border-radius: 14px;
      background: rgba(255,92,108,.10);
      border: 1px solid rgba(255,92,108,.25);
      color: rgba(255,210,214,.95);
      font-size: 13px;
    }

    .footer-mini{
      margin-top: 12px;
      display:flex;
      justify-content:space-between;
      gap:10px;
      color: rgba(234,240,255,.55);
      font-size: 12px;
      padding: 0 2px;
    }

    @media (max-width:420px){
      .card-inner{ padding: 16px 14px 14px; }
      .title h1{ font-size: 20px; }
      .ico{ width:32px;height:32px; border-radius:11px; }
      .pw-toggle{ padding: 8px 9px; }
    }
  </style>
</head>

<body>
  <div class="bg"></div>

  <div class="nav">
    <div class="container">
      <div class="brand">
        <a href="index.html" style="display:flex;align-items:center;gap:10px;text-decoration:none;color:inherit;">
          <img src="logo.png" alt="Logo" class="logo">
          <div class="brand-title">
            <!-- <strong>JYRA</strong> -->
            <span>Secure Client Login</span>
          </div>
        </a>
      </div>
      <div></div>
    </div>
  </div>

  <div class="wrap">
    <div class="card">
      <div class="card-inner">
        <div class="title">
          <h1>Login</h1>
          <p>Enter your Phone / Client ID and Password</p>
          <div class="accent-line"></div>
        </div>

        <!-- ‚úÖ UI only. Function/JS unchanged -->
        <div class="field">
          <label>Phone or Client ID</label>
          <div class="control">
            <div class="ico">üë§</div>
            <input id="pid" placeholder="98xxxxxxxx or C12345 / ADMIN1xxx" autocomplete="username" />
          </div>
        </div>

        <div class="field">
          <label>Password</label>
          <div class="control">
            <div class="ico">üîí</div>
            <input id="pass" type="password" placeholder="Password" autocomplete="current-password" />
            <button type="button" class="pw-toggle" id="togglePass" aria-label="Toggle password">üëÅÔ∏è</button>
          </div>
        </div>

        <button class="btn" id="btnLogin" type="button">Login</button>

        <div class="notice" id="msg" style="display:none;"></div>

        <div class="footer-mini">
          <span>Protected access</span>
          <span>v1.0</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Firebase compat -->
  <script src="https://www.gstatic.com/firebasejs/10.12.5/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.5/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.5/firebase-firestore-compat.js"></script>

  <script>
    window.firebaseConfig = {
      apiKey: "AIzaSyBZFAk80TlzESxnFNlG0uonVyLj3bQ3PRo",
      authDomain: "wingo-app-f68dd.firebaseapp.com",
      projectId: "wingo-app-f68dd",
      storageBucket: "wingo-app-f68dd.firebasestorage.app",
      messagingSenderId: "533037771285",
      appId: "1:533037771285:web:d72372f86108a8379dbc1c",
      measurementId: "G-RJ1XX4FX3W"
    };
  </script>

  <!-- your existing logic -->
  <script src="app.js"></script>

  <script>
    (function(){
      const pidEl = document.getElementById("pid");
      const passEl = document.getElementById("pass");
      const btn = document.getElementById("btnLogin");
      const msgEl = document.getElementById("msg");
      const toggleBtn = document.getElementById("togglePass");

      function showMsg(t){ msgEl.style.display="block"; msgEl.textContent=t; }
      function hideMsg(){ msgEl.style.display="none"; msgEl.textContent=""; }

      function redirectByRole(u){
        if(!u) return;
        window.location.href = (u.role==="admin") ? "admin.html" : "game.html";
      }

      // ‚úÖ password toggle
      toggleBtn.addEventListener("click", function(){
        if(passEl.type==="password"){ passEl.type="text"; toggleBtn.textContent="üôà"; }
        else{ passEl.type="password"; toggleBtn.textContent="üëÅÔ∏è"; }
      });

      // ‚úÖ Enter key login (NO refresh)
      document.addEventListener("keydown", function(e){
        if(e.key === "Enter"){
          e.preventDefault();
          e.stopPropagation();
          btn.click();
        }
      });

      // ‚úÖ Login click
      btn.addEventListener("click", async function(e){
        e.preventDefault();
        e.stopPropagation();
        hideMsg();

        if(typeof window.loginSecure !== "function"){
          showMsg("Error: app.js not loaded (loginSecure missing). Check file path + hard refresh (Ctrl+Shift+R).");
          return;
        }

        const phoneOrId = (pidEl.value||"").trim();
        const password = (passEl.value||"").trim();

        if(!phoneOrId || !password){
          showMsg("Please enter ID/Phone and Password.");
          return;
        }

        btn.disabled = true;
        btn.textContent = "Logging in...";

        try{
          const r = await window.loginSecure({ phoneOrId, password });
          if(!r || !r.ok){
            showMsg(r?.msg || "Login failed.");
            return;
          }
          redirectByRole(r.user);
        }catch(err){
          showMsg("Error: " + (err?.message || String(err)));
        }finally{
          btn.disabled = false;
          btn.textContent = "Login";
        }
      });

      // ‚úÖ already logged in redirect
      (async function(){
        try{
          if(typeof window.currentUserAsync === "function"){
            const u = await window.currentUserAsync();
            if(u) redirectByRole(u);
          }
        }catch(_){}
      })();
    })();
  </script>
</body>
</html>


